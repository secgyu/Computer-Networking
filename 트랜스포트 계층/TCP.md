# 🌐 TCP (Transmission Control Protocol) 상세 설명

## 📝 개요
TCP(Transmission Control Protocol)는 인터넷에서 데이터를 신뢰성 있게 전송하기 위해 사용되는 **연결형 프로토콜**입니다. TCP는 데이터의 정확한 전송을 보장하기 위해 다양한 기능을 제공합니다.

## 🔍 주요 특징
1. **연결 설정 및 해제**: 데이터를 전송하기 전에 연결을 설정하고, 데이터 전송이 끝나면 연결을 해제합니다.
2. **신뢰성 있는 데이터 전송**: 데이터의 손실, 중복, 순서 변경 없이 전송을 보장합니다.
3. **흐름 제어**: 송신자가 수신자의 처리 능력을 초과하지 않도록 데이터 전송 속도를 조절합니다.
4. **혼잡 제어**: 네트워크의 혼잡을 방지하기 위해 데이터 전송 속도를 조절합니다.
5. **오류 검출 및 수정**: 데이터의 무결성을 확인하고, 손상된 데이터를 재전송합니다.

## 📦 TCP 세그먼트 구조
TCP 세그먼트는 기본적으로 20바이트의 헤더와 데이터로 구성됩니다. 헤더는 다음과 같은 필드로 구성됩니다:

- **출발지 포트 번호 (Source Port Number)**: 16비트
- **목적지 포트 번호 (Destination Port Number)**: 16비트
- **순서 번호 (Sequence Number)**: 32비트, 세그먼트 내 데이터의 첫 번째 바이트의 위치를 나타냅니다.
- **확인 응답 번호 (Acknowledgment Number)**: 32비트, 다음에 수신할 바이트의 위치를 나타냅니다.
- **데이터 오프셋 (Data Offset)**: 4비트, TCP 헤더의 길이를 32비트 단위로 나타냅니다.
- **예약 필드 (Reserved)**: 6비트, 현재 사용되지 않음.
- **플래그 (Flags)**: 6비트, 제어 플래그 (URG, ACK, PSH, RST, SYN, FIN)로 구성됩니다.
- **윈도우 크기 (Window Size)**: 16비트, 수신자가 한 번에 수신할 수 있는 데이터의 양을 나타냅니다.
- **체크섬 (Checksum)**: 16비트, 데이터의 무결성을 확인하기 위한 값입니다.
- **긴급 포인터 (Urgent Pointer)**: 16비트, 긴급 데이터의 끝을 나타냅니다.
- **옵션 (Options)**: 가변 길이, 확장 기능을 제공하기 위해 사용됩니다.

## ⚙️ TCP 연결 설정 및 해제
TCP 연결은 3-way handshake 과정을 통해 설정되고, 4-way handshake 과정을 통해 해제됩니다.

### 3-way Handshake (연결 설정)
1. **SYN**: 클라이언트가 서버에 연결 요청을 보냅니다. (SYN 플래그 설정)
2. **SYN-ACK**: 서버가 요청을 수락하고, 클라이언트에게 응답을 보냅니다. (SYN 플래그와 ACK 플래그 설정)
3. **ACK**: 클라이언트가 서버의 응답을 확인하고, 연결이 설정됩니다. (ACK 플래그 설정)

```plaintext
Client           Server
   | SYN           |
   | ------------> |
   |               |
   |  SYN-ACK      |
   | <------------ |
   |               |
   |     ACK       |
   | ------------> |
   |               |
```

### 4-way Handshake (연결 해제)
1. **FIN**: 클라이언트가 연결 종료 요청을 보냅니다. (FIN 플래그 설정)
2. **ACK**: 서버가 요청을 확인합니다. (ACK 플래그 설정)
3. **FIN**: 서버가 연결 종료 요청을 보냅니다. (FIN 플래그 설정)
4. **ACK**: 클라이언트가 요청을 확인하고, 연결이 해제됩니다. (ACK 플래그 설정)

```plaintext
Client           Server
   | FIN           |
   | ------------> |
   |               |
   |     ACK       |
   | <------------ |
   |               |
   |     FIN       |
   | <------------ |
   |               |
   |     ACK       |
   | ------------> |
   |               |
```

## 📡 TCP의 신뢰성 있는 데이터 전송
TCP는 데이터의 신뢰성을 보장하기 위해 여러 가지 메커니즘을 사용합니다.

### 순서 번호와 확인 응답
- **순서 번호 (Sequence Number)**: 각 세그먼트의 데이터는 순서 번호가 매겨져 전송됩니다.
- **확인 응답 번호 (Acknowledgment Number)**: 수신자는 수신한 데이터의 다음 순서 번호를 송신자에게 알립니다.

### 재전송
TCP는 데이터가 손실되었을 때 재전송 메커니즘을 사용합니다. 송신자는 특정 시간 동안 확인 응답을 받지 못하면 데이터를 재전송합니다.

## 혼잡 제어 (Congestion Control)
TCP는 네트워크의 혼잡을 방지하기 위해 혼잡 제어 알고리즘을 사용합니다.

### 슬로우 스타트 (Slow Start)
송신자는 네트워크 상태를 파악하기 위해 전송 속도를 점진적으로 증가시킵니다.

### 혼잡 회피 (Congestion Avoidance)
송신자는 혼잡 상태를 피하기 위해 전송 속도를 선형적으로 증가시킵니다.

### 빠른 재전송 (Fast Retransmit) 및 빠른 회복 (Fast Recovery)
송신자는 중복된 확인 응답을 수신하면 빠르게 데이터를 재전송하고, 혼잡 상태에서 빠르게 회복합니다.

## 🔧 TCP의 흐름 제어 (Flow Control)
TCP는 수신자의 수신 능력을 초과하지 않도록 데이터를 조절합니다.   
수신자는 윈도우 크기 필드를 사용하여 송신자에게 수신 가능한 데이터의 양을 알립니다.   
송신자는 이 값을 참고하여 데이터를 전송합니다.

## 💬 TCP 사용 사례
TCP는 신뢰성 있는 데이터 전송이 필요한 응용 프로그램에서 주로 사용됩니다.   
예를 들어, **웹 브라우징 (HTTP/HTTPS)**, **파일 전송 (FTP)**, **이메일 (SMTP)**, **원격 접속 (SSH, Telnet)** 등이 있습니다.

## ⚖️ TCP와 UDP 비교

| **특징** | **TCP** | **UDP** |
| --- | --- | --- |
| **연결 여부** | 연결형 | 연결형 |
| **신뢰성** | 높음 | 낮 |
| **전송 속도** | 느림 | 빠 |
| **오버헤드** | 큼 | 작 |
| **흐름제어** | 있음 | 없음 |
| **혼잡제어** | 있음 | 없음 |
| **사용 사례** | 웹 브라우징, 파일 전송, 이메일, 원격 접속 | 실시간 스트리밍, 온라인 게임, DNS 조회, VoIP |

TCP는 신뢰성 있는 데이터 전송이 필요한 응용 프로그램에서 널리 사용됩니다.  
데이터의 신뢰성이 중요한 경우 TCP를 선택하는 것이 적절합니다.
