# 패킷교환 : 지연

![네트워크 설정 정보](https://github.com/secgyu/Computer-Networking/blob/main/%EC%A7%80%EC%97%B0%EC%8B%9C%EA%B0%84.png)
패킷이 경로를 따라 한 노드에서 다음 노드로 전달될 때 패킷은 경로상의 **각 노드에서** 다양한 지연을 겪게 되며,  
이들은 쌓여서 `전체 노드 지연(total nodal delay)`을 일으킨다.

- `노드 처리 지연(nodal processing delay)`
- `큐잉 지연(queuing delay)`
- `전송 지연(transmission delay)`
- `전파 지연(propagation delay)`

### 처리 지연(processing delay)

> :star: 패킷 헤더를 조사하고 그 패킷을 어디로 보낼지 결정하는 시간

- 라우터 A로 패킷의 비트를 전송할 때 업스트림 노드에서 발생하는 **패킷의 비트 레벨 오류를 조사**하는 데 필요한 시간과 같은 요소를 포함할 수도 있다.
- 라우터는 이 노드 처리 후, 그 패킷을 라우터 B에 이르는 링크에 앞선 큐에 보낸다.
- 고속 라우터의 처리 지연은 일반적으로 수 마이크로초이다.

<br/>

### 큐잉 지연(queuing delay)

> :star: 패킷이 큐에서 링크로 전송되기를 기다리는 시간

- 특정 패킷의 큐잉 지연 길이는 큐에 저장되어 링크로 전송되기를 기다리는, **앞서 도착한 다른 패킷의 수에 의해 결정된다.**
- 주어진 패킷의 지연은 패킷마다 상당히 다르다.
    - 큐가 비어있고 다른 패킷이 전송 중인 상태가 아니라면 패킷의 큐잉 지연 → 0
    - 트래픽이 많고 다른 많은 패킷이 전송 대기 중이라면 패킷의 큐잉 지연 → 매우 길어진다.
- 수 마이크로초 ~ 수 밀리초

<br/>

### 전송 지연(transmission delay)

> :star: 패킷의 모든 비트를 링크로 밀어내는 데(또는 전송하는 데) 필요한 시간


패킷이 **선입선출(FIFO)** 방식으로 전송된다고 가정해보자. (앞서 도착한 다른 모든 패킷이 전송된 다음에 전송)

패킷의 길이는 `L 비트`, 라우터 A에서 라우터 B까지 링크의 전송률은 `R bps`라고 해보자. (R는 라우터 B로 가는 링크의 전송률에 의해 결정됨)

이때 전송 지연은 `L/R`이다. (수 마이크로초 ~ 수 밀리초)

<br/>

### 전파 지연(propagation delay)

> :star: 비트가 라우터 A 상에서의 링크에서 라우터 B까지의 전파에 필요한 시간

- 비트는 링크의 전파 속도로 전파된다.
- 전파 속도는 링크의 물리 매체(광섬유, 꼬임쌍선 등)에 따라 다르며, 범위는 2×(10^8)미터/초 ~ 3×(10^8)미터/초이다.  
  → 빛의 속도와 같거나 약간 작다.

라우터 A와 B 사이의 거리를 `d`, 링크의 전파 속도를 `s`라고 한다면 전파 지연은 `d/s`이다. (일반적으로 수 밀리초)

### 종단 간 지연

> 종단 간 지연 = N(처리 지연 + 전송 지연(L/R) + 전파 지연)

<br/>

# 패킷 손실 (Packet Loss)

![네트워크 설정 정보](https://github.com/secgyu/Computer-Networking/blob/main/%ED%8A%B8%EB%9E%98%ED%94%BD%EA%B0%95%EB%8F%84.png)

### 트래픽 강도 (Traffic Intensity)
트래픽 강도는 `La/R`로 정의됩니다. 여기서:
- **L**: 패킷 크기 (단위: bits)
- **a**: 패킷이 생성되는 평균 속도 (단위: 패킷/초)
- **R**: 데이터 전송율 (단위: bps, 비트/초)

트래픽 강도는 네트워크의 부하를 나타내는 지표로, `La`는 비트 단위의 총 트래픽을 의미하며, `R`은 링크가 처리할 수 있는 최대 비트 수를 나타냅니다.

### 트래픽 강도에 따른 특성
- **La/R > 1**:
  - 네트워크는 들어오는 트래픽을 감당할 수 없으며, 패킷 손실이 발생합니다.
  - 버퍼가 모두 차게 되면, 새로 도착하는 패킷은 처리될 수 없어 네트워크는 포화 상태에 도달합니다.
  - 이는 패킷이 네트워크 장치에서 처리되기 전에 대기해야 하며, 이 대기로 인해 큐의 overflow가 발생하고, 결과적으로 패킷 손실이 발생합니다.

- **La/R ≤ 1**:
  - 트래픽이 전송 속도(R)보다 낮거나 같아서 모든 패킷이 능률적으로 처리됩니다.
  - 이 경우에는 패킷 지연은 있을 수 있으나, 버퍼 오버플로로 인한 패킷 손실은 발생하지 않습니다.
  - 네트워크는 모든 트래픽을 효과적으로 처리할 수 있습니다.

### 그래프 설명
트래픽 강도(`La/R`)가 1을 초과하는 경우, 패킷 손실률이 급격히 증가하는 것을 그래프로 나타냈습니다. 이 그래프는 트래픽 강도가 증가함에 따라 네트워크가 어떻게 포화상태에 도달하는지 시각적으로 보여줍니다.
